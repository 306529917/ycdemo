<!DOCTYPE html>
<html style="height: 100%">
<head>
<meta charset="UTF-8">
<title>正则表达式</title>
<script src="https://cdn.bootcss.com/jquery/3.5.0/jquery.js"></script>
<script src="https://cdn.bootcss.com/vue/2.6.11/vue.js"></script>
<style type="text/css">
body{
	padding: 10px
}
.res{
	display: inline-block;
	margin : 0px 5px;
	width: 60px;
	height: 20px;
	line-height:20px;
}
input {
	color:blue;
	text-align: center;
	font-size: 1.2em;
	font-weight : bold;
	border-top:none;
	border-left:none;
	border-right:none;
	border-bottom : 1px solid #555;
	background: inherit;
}
.qlist dl{
	padding: 5px;
	border: 1px solid #ccc;
	background: #eee;
	border-radius: 5px;
}
.qlist dl:hover{
	border-color: blue;
}
.qlist{
	overflow: auto; 
}
</style>
</head>
<body>
	<div id="main">
		<fieldset class="alist">
			<legend>答题结果</legend>
			<span class="res" v-for="q,i in questions">
				题{{i+1}}: <b style="color: red">{{q.result?'对':''}}</b>
			</span>
		</fieldset>
		<fieldset>
			<legend>题目: 请按照要求再横线处填写代码, 浏览器控制台会打印每道题的返回结果</legend>
			<div class="qlist">
			<dl v-for="q,i in questions" :style="{backgroundColor:q.result?'#ddd':'#eee'}">
				<dt>第{{i+1}}题 <b style="color: red">{{q.result?'对':''}}</b></dt>
				<dd>
					<span v-html="prefix( q.content )"></span>
					<input @change="test( q, $event )">
					<span v-html="suffix( q.content ) + (q.expect!=undefined?q.expect:'')"></span>
				</dd>
			</dl>
			</div>
		</fieldset>
	</div>
	<script type="text/javascript">
		function Q(content, expect, validate){
			this.content = content;
			this.validate = validate;
			if(expect) this.expect = expect;
			this.result = false;
		}
		new Vue({
			el : "#main",
			data : {
				questions : [
					new Q("var data = 'CAt';<br>var reg = 答题线; //定义正则表达式判断data中是否包含 At<br>reg.test(data); // 要求返回 ", true),
					new Q("var data = 'CAt';<br>var reg = 答题线; //定义正则表达式判断data中是否包含 at(忽略大小写)<br>reg.test(data); // 要求返回 ", true, 
							{expr:/at/,msg:'代码必须包含字符串: at'}),
					new Q("var data = '你好世界';<br>var reg = 答题线; //定义正则表达式判断data中是否包含 好 字<br>reg.test(data); // 要求返回 ", true,
							{expr: new RegExp("new"),msg:'代码必须包含字符串: new'}),
					new Q("var data = '正则表达式';<br>var reg = /正则/; <br>reg.答题线(data); // 要求返回 ", true),
					new Q("var data = '正则表达式';<br>var reg = /表达/; <br>var ret = reg.答题线(data);<br>ret.index; // 要求返回 2"),
					new Q("var data = '字符串的match使用正则表达式模式对字符串执行查找，并将包含查找的结果作为数组返回';<br>var reg = /的/; <br>var ret = data.search(reg);<br>ret == 答题线; // 请填写 ret 的值, 要求返回 true"),
					new Q("var data = '字符串的match使用正则表达式模式对字符串执行查找，并将包含查找的结果作为数组返回';<br>var regex = /c/; <br>答题线; // 请填写方法找到字符 c, 返回 ", 7),
					new Q("var data = '字符串的search方法返回与正则表达式查找内容匹配的第一个子字符串的位置';<br>var reg = /的/; <br>var r = 答题线;// 查找 的 字 <br>r.index;// 返回 ", 3),
					new Q("var data = '小猫笑我,我笑猫小';<br>答题线;// 请将'我'字替换成'你'字, 返回:", '小猫笑你,你笑猫小'),
					new Q("var data = '小猫笑我,我笑猫小';<br>答题线;// 根据结果填写<br>data// data的值, 返回:", '小狗笑我,我笑狗小'),
					new Q("var data = '小明,小红,小黄,小丽';<br>答题线;// 拆分数组<br>arr.length// 返回:", 4),
				]
			},
			methods : {
				test(q,event){
					var value = event.srcElement.value;
					if(q.validate){
						if( ! q.validate.expr.test(value)) {
							alert(q.validate.msg);
							return;
						}
					}
					var script = q.content.replace(/<br>/gi,'\r\n');
					script = script.replace('答题线',value);
					try{
						var ret = eval(script);
						console.info("您输入的是: " + value + " ,运算的结果如下:");
						console.info(ret);
						q.result = q.expect != undefined ? ret == q.expect : true;
					}catch(e){
						console.error(e);
						q.result = false;
					}
				},
				prefix(text){
					return text.substring(0, text.indexOf('答题线'));
				},
				suffix(text){
					return text.substring(text.indexOf('答题线') + 3);
				}
			},
			
		});
	</script>
</body>
</html>